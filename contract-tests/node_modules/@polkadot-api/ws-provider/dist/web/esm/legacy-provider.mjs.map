{"version":3,"file":"legacy-provider.mjs","sources":["../../../src/legacy-provider.ts"],"sourcesContent":["import type { StatusChange, WsJsonRpcProvider } from \"./types-common\"\nimport type { GetWsProviderInput } from \"./types-legacy\"\nimport {\n  getWsProvider,\n  mapEndpoints,\n  defaultConfig,\n  noop,\n} from \"./default-provider\"\nimport { type WebSocketClass } from \"./types-new\"\n\nexport const getLegacyWsProvider = (\n  websocketClass: WebSocketClass,\n): GetWsProviderInput => {\n  return (...args): WsJsonRpcProvider => {\n    let endpoints: Array<[string, string | string[]] | [string]> = []\n    let { heartbeatTimeout, timeout, innerEnhancer, onStatusChanged } =\n      defaultConfig\n\n    const [firstArg] = args\n    if (\n      args.length === 1 &&\n      typeof firstArg === \"object\" &&\n      !Array.isArray(firstArg)\n    ) {\n      endpoints = mapEndpoints(firstArg.endpoints)\n      onStatusChanged = firstArg.onStatusChanged ?? noop\n      timeout = firstArg.timeout ?? timeout\n      heartbeatTimeout = firstArg.heartbeatTimeout ?? heartbeatTimeout\n      innerEnhancer = firstArg.innerEnhancer ?? ((x) => x)\n    } else {\n      if (typeof args[1] === \"function\")\n        onStatusChanged = args[1] as (status: StatusChange) => void\n      if (Array.isArray(firstArg)) endpoints = mapEndpoints(firstArg)\n      else {\n        endpoints = [[firstArg as string]]\n        if (args[1] && args[1] !== onStatusChanged)\n          endpoints[0][1] = args[1] as any\n        if (args[2]) onStatusChanged = args[2] as any\n      }\n    }\n\n    return getWsProvider(\n      endpoints.map((x) =>\n        x.length === 1\n          ? x[0]\n          : {\n              uri: x[0],\n              protocol: x[1],\n            },\n      ),\n      {\n        websocketClass,\n        onStatusChanged,\n        timeout,\n        innerEnhancer,\n      },\n    )\n  }\n}\n"],"names":[],"mappings":";;AAUO,MAAM,mBAAA,GAAsB,CACjC,cAAA,KACuB;AACvB,EAAA,OAAO,IAAI,IAAA,KAA4B;AACrC,IAAA,IAAI,YAA2D,EAAC;AAChE,IAAA,IAAI,EAAE,gBAAA,EAAkB,OAAA,EAAS,aAAA,EAAe,iBAAgB,GAC9D,aAAA;AAEF,IAAA,MAAM,CAAC,QAAQ,CAAA,GAAI,IAAA;AACnB,IAAA,IACE,IAAA,CAAK,MAAA,KAAW,CAAA,IAChB,OAAO,QAAA,KAAa,YACpB,CAAC,KAAA,CAAM,OAAA,CAAQ,QAAQ,CAAA,EACvB;AACA,MAAA,SAAA,GAAY,YAAA,CAAa,SAAS,SAAS,CAAA;AAC3C,MAAA,eAAA,GAAkB,SAAS,eAAA,IAAmB,IAAA;AAC9C,MAAA,OAAA,GAAU,SAAS,OAAA,IAAW,OAAA;AAC9B,MAAA,gBAAA,GAAmB,SAAS,gBAAA,IAAoB,gBAAA;AAChD,MAAA,aAAA,GAAgB,QAAA,CAAS,aAAA,KAAkB,CAAC,CAAA,KAAM,CAAA,CAAA;AAAA,IACpD,CAAA,MAAO;AACL,MAAA,IAAI,OAAO,IAAA,CAAK,CAAC,CAAA,KAAM,UAAA;AACrB,QAAA,eAAA,GAAkB,KAAK,CAAC,CAAA;AAC1B,MAAA,IAAI,MAAM,OAAA,CAAQ,QAAQ,CAAA,EAAG,SAAA,GAAY,aAAa,QAAQ,CAAA;AAAA,WACzD;AACH,QAAA,SAAA,GAAY,CAAC,CAAC,QAAkB,CAAC,CAAA;AACjC,QAAA,IAAI,IAAA,CAAK,CAAC,CAAA,IAAK,IAAA,CAAK,CAAC,CAAA,KAAM,eAAA;AACzB,UAAA,SAAA,CAAU,CAAC,CAAA,CAAE,CAAC,CAAA,GAAI,KAAK,CAAC,CAAA;AAC1B,QAAA,IAAI,IAAA,CAAK,CAAC,CAAA,EAAG,eAAA,GAAkB,KAAK,CAAC,CAAA;AAAA,MACvC;AAAA,IACF;AAEA,IAAA,OAAO,aAAA;AAAA,MACL,SAAA,CAAU,GAAA;AAAA,QAAI,CAAC,CAAA,KACb,CAAA,CAAE,WAAW,CAAA,GACT,CAAA,CAAE,CAAC,CAAA,GACH;AAAA,UACE,GAAA,EAAK,EAAE,CAAC,CAAA;AAAA,UACR,QAAA,EAAU,EAAE,CAAC;AAAA;AACf,OACN;AAAA,MACA;AAAA,QACE,cAAA;AAAA,QACA,eAAA;AAAA,QACA,OAAA;AAAA,QACA;AAAA;AACF,KACF;AAAA,EACF,CAAA;AACF;;;;"}